<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ room['title'] }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #0e1117;
        }

        .navbar-brand {
            font-weight: bold;
        }

        .card {
            background-color: #1a1f2e;
            border: 1px solid #333;
            margin-bottom: 1rem;
        }

        .card-header {
            font-weight: bold;
            font-size: 1.1rem;
            color: #a0a0ff;
        }

        .btn-primary {
            background-color: #0068c9;
            border: none;
        }

        .btn-success {
            background-color: #00a06c;
            border: none;
        }

        .btn-secondary {
            background-color: #444;
            border: none;
        }

        .question-correct {
            background-color: #1a2f1e;
            border-color: #00a06c;
        }

        .answer-result {
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .hint {
            font-size: 0.9rem;
            color: #999;
            padding: 10px;
            background-color: #222;
            border-radius: 5px;
            margin-top: 5px;
            display: none;
        }

        #toast-area {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 1050;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/">SOC-CTF Platform</a>
            <a class="btn btn-outline-info" href="/leaderboard">Leaderboard</a>
        </div>
    </nav>

    <div class="container my-4">
        <h2>{{ room['title'] }}</h2>
        <p class="lead">{{ room['description'] }}</p>

        <div class="d-flex gap-2 mb-4">
            <a href="/room/{{ room['id'] }}/log" class="btn btn-success btn-lg">Download `{{ room['log_file'] }}`</a>
            <a href="http://localhost:8501" target="_blank" class="btn btn-primary btn-lg">Open SOC Analyzer (Tool)</a>
        </div>

        <div class="mb-3">
            <label for="global-nickname" class="form-label">Your Nickname (for Leaderboard)</label>
            <input type="text" class="form-control" id="global-nickname" placeholder="Enter your nickname..."
                autocomplete="off">
        </div>

        <hr>

        <h4>Challenge Questions</h4>

        {% for q in questions %}
        <div class="card" id="qwrap-{{ q['key'] }}">
            <div class="card-body">
                <h5 class="card-title">Task {{ loop.index }}</h5>
                <p class="card-text">{{ q['prompt'] | safe }}</p>
                <div class="input-group">
                    <input type="text" class="form-control" placeholder="Type your answer (flag) here..."
                        id="ans-{{ q['key'] }}" autocomplete="off">
                    <button class="btn btn-primary" onclick="submitAnswer('{{ q['key'] }}')">Submit</button>
                </div>
                <div id="res-{{ q['key'] }}" class="answer-result"></div>
                <a href="javascript:void(0)" onclick="toggleHint('{{ q['key'] }}')" class="small text-muted">Show
                    hint</a>
                <div class="hint" id="hint-{{ q['key'] }}">{{ q['hint'] }}</div>
            </div>
        </div>
        {% endfor %}

    </div>

    <div id="toast-area"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/js/app.js"></script>
</body>

</html>